<svg width="1400" height="900" viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <!-- 箭头标记 -->
      <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
      </marker>
      <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#2196f3" />
      </marker>
      <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50" />
      </marker>
      
      <!-- 渐变定义 -->
      <linearGradient id="inputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="embeddingGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="improvedGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#fff59d;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#ffcc02;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="rnnGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#e8f5e8;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="informerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="outputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#ffebee;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#ffcdd2;stop-opacity:1" />
      </linearGradient>
    </defs>
  
    <!-- 背景 -->
    <rect width="1400" height="900" fill="#fafafa"/>
    
    <!-- 标题 -->
    <text x="700" y="30" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle" fill="#333">R-Informer Architecture</text>
    <text x="700" y="55" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" fill="#666">基于RNN嵌入层的改进Informer时间序列预测架构</text>
  
    <!-- 第一层：输入层 -->
    <rect x="50" y="100" width="180" height="80" rx="12" fill="url(#inputGradient)" stroke="#1976d2" stroke-width="3"/>
    <text x="140" y="130" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#1976d2">Input Time Series</text>
    <text x="140" y="150" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#1976d2">时间序列输入</text>
  
    <!-- 第二层：Input Embedding Layer -->
    <rect x="280" y="80" width="400" height="160" rx="15" fill="url(#embeddingGradient)" stroke="#7b1fa2" stroke-width="3"/>
    <text x="480" y="110" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#7b1fa2">Input Embedding Layer</text>
    
    <!-- Token Embedding -->
    <rect x="300" y="130" width="100" height="50" rx="8" fill="#ede7f6" stroke="#7b1fa2" stroke-width="2"/>
    <text x="350" y="150" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Token</text>
    <text x="350" y="165" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Embedding</text>
    
    <!-- Positional Embedding -->
    <rect x="420" y="130" width="100" height="50" rx="8" fill="#ede7f6" stroke="#7b1fa2" stroke-width="2"/>
    <text x="470" y="150" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Positional</text>
    <text x="470" y="165" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Embedding</text>
    
    <!-- Temporal Embedding (Improved) -->
    <rect x="540" y="130" width="100" height="50" rx="8" fill="url(#improvedGradient)" stroke="#f9a825" stroke-width="4"/>
    <text x="590" y="145" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Temporal</text>
    <text x="590" y="160" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Embedding</text>
    <text x="590" y="175" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#f57c00">🔥 Improved</text>
    
    <!-- Sum & Concat -->
    <rect x="400" y="200" width="120" height="30" rx="8" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
    <text x="460" y="220" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#333">Sum and Concat</text>
  
    <!-- 第三层：LocalRNN Layer -->
    <rect x="730" y="80" width="250" height="180" rx="15" fill="url(#rnnGradient)" stroke="#388e3c" stroke-width="3"/>
    <text x="855" y="110" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#388e3c">LocalRNN Layer</text>
    
    <!-- K-Size Partitioning -->
    <rect x="750" y="130" width="100" height="45" rx="8" fill="#f5f5f5" stroke="#616161" stroke-width="2"/>
    <text x="800" y="148" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">K-Size</text>
    <text x="800" y="163" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">Partitioning</text>
    
    <!-- Feature Aggregation -->
    <rect x="870" y="130" width="100" height="45" rx="8" fill="#f5f5f5" stroke="#616161" stroke-width="2"/>
    <text x="920" y="148" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">Feature</text>
    <text x="920" y="163" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">Aggregation</text>
    
    <!-- RNN Cell Processing -->
    <rect x="810" y="190" width="100" height="45" rx="8" fill="#f5f5f5" stroke="#616161" stroke-width="2"/>
    <text x="860" y="208" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">RNN Cell</text>
    <text x="860" y="223" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">Processing</text>
  
    <!-- 第四层：R-Informer Layer -->
    <rect x="80" y="300" width="1240" height="400" rx="20" fill="url(#informerGradient)" stroke="#f57c00" stroke-width="4"/>
    <text x="700" y="330" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#f57c00">R-Informer Layer</text>
  
    <!-- Encoder部分 -->
    <rect x="120" y="360" width="550" height="310" rx="15" fill="#f8f8f8" stroke="#616161" stroke-width="2"/>
    <text x="395" y="385" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">Encoder</text>
    
    <!-- Conv1D Layer -->
    <rect x="320" y="400" width="150" height="35" rx="8" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
    <text x="395" y="422" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Conv1D Layer 卷积层</text>
    
    <!-- Encoder Layer 1 -->
    <rect x="140" y="450" width="200" height="130" rx="10" fill="#e0e0e0" stroke="#616161" stroke-width="2"/>
    <text x="240" y="475" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Encoder Layer 1</text>
    
    <rect x="155" y="490" width="170" height="25" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="1"/>
    <text x="240" y="508" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Multi-head ProbSparse Self-attention</text>
    
    <rect x="155" y="525" width="80" height="22" rx="4" fill="#e8f5e8" stroke="#4caf50" stroke-width="1"/>
    <text x="195" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Layer Norm</text>
    
    <rect x="245" y="525" width="80" height="22" rx="4" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
    <text x="285" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Feed Forward</text>
    
    <!-- Encoder Layer 2 -->
    <rect x="360" y="450" width="200" height="130" rx="10" fill="#e0e0e0" stroke="#616161" stroke-width="2"/>
    <text x="460" y="475" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Encoder Layer 2</text>
    
    <rect x="375" y="490" width="170" height="25" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="1"/>
    <text x="460" y="508" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Multi-head ProbSparse Self-attention</text>
    
    <rect x="375" y="525" width="80" height="22" rx="4" fill="#e8f5e8" stroke="#4caf50" stroke-width="1"/>
    <text x="415" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Layer Norm</text>
    
    <rect x="465" y="525" width="80" height="22" rx="4" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
    <text x="505" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Feed Forward</text>
  
    <!-- Encoder Output -->
    <rect x="320" y="600" width="150" height="40" rx="8" fill="#4caf50" stroke="#2e7d32" stroke-width="2"/>
    <text x="395" y="625" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">Encoder Output</text>
  
    <!-- Decoder部分 -->
    <rect x="730" y="360" width="550" height="310" rx="15" fill="#f8f8f8" stroke="#616161" stroke-width="2"/>
    <text x="1005" y="385" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">Decoder</text>
    
    <!-- Decoder Input -->
    <rect x="750" y="400" width="120" height="35" rx="8" fill="#ffebee" stroke="#f44336" stroke-width="2"/>
    <text x="810" y="422" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Decoder Input</text>
    
    <!-- Decoder Conv1D -->
    <rect x="890" y="400" width="120" height="35" rx="8" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
    <text x="950" y="422" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Conv1D Layer</text>
    
    <!-- Decoder Layer -->
    <rect x="750" y="450" width="500" height="150" rx="10" fill="#e0e0e0" stroke="#616161" stroke-width="2"/>
    <text x="1000" y="475" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Decoder Layer</text>
    
    <rect x="770" y="490" width="200" height="25" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="1"/>
    <text x="870" y="508" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Masked Multi-head ProbSparse Self-attention</text>
    
    <rect x="770" y="525" width="80" height="22" rx="4" fill="#e8f5e8" stroke="#4caf50" stroke-width="1"/>
    <text x="810" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Layer Norm</text>
    
    <rect x="870" y="525" width="150" height="22" rx="4" fill="#e1f5fe" stroke="#03a9f4" stroke-width="1"/>
    <text x="945" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Multi-head Cross Attention</text>
    
    <rect x="1040" y="525" width="80" height="22" rx="4" fill="#e8f5e8" stroke="#4caf50" stroke-width="1"/>
    <text x="1080" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Layer Norm</text>
    
    <rect x="1150" y="525" width="80" height="22" rx="4" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
    <text x="1190" y="539" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Feed Forward</text>
    
    <rect x="920" y="560" width="150" height="22" rx="4" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
    <text x="995" y="574" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Feed Forward Network</text>
  
    <!-- Decoder Output -->
    <rect x="930" y="620" width="150" height="40" rx="8" fill="#4caf50" stroke="#2e7d32" stroke-width="2"/>
    <text x="1005" y="645" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">Decoder Output</text>
  
    <!-- 第五层：Final Output -->
    <rect x="600" y="750" width="200" height="80" rx="12" fill="url(#outputGradient)" stroke="#d32f2f" stroke-width="3"/>
    <text x="700" y="780" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#d32f2f">Final Prediction</text>
    <text x="700" y="805" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#d32f2f">预测结果</text>
  
    <!-- 连接线和箭头 -->
    <!-- Input to Embedding -->
    <line x1="230" y1="140" x2="280" y2="140" stroke="#1976d2" stroke-width="3" marker-end="url(#arrowBlue)"/>
    
    <!-- Embedding internal connections -->
    <line x1="350" y1="180" x2="440" y2="200" stroke="#7b1fa2" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="470" y1="180" x2="460" y2="200" stroke="#7b1fa2" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="590" y1="180" x2="480" y2="200" stroke="#f9a825" stroke-width="3" marker-end="url(#arrowhead)"/>
    
    <!-- Embedding to RNN -->
    <line x1="520" y1="215" x2="730" y2="170" stroke="#4caf50" stroke-width="3" marker-end="url(#arrowGreen)"/>
    
    <!-- RNN internal connections -->
    <line x1="850" y1="155" x2="870" y2="155" stroke="#616161" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="920" y1="175" x2="860" y2="190" stroke="#616161" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- RNN to R-Informer -->
    <line x1="855" y1="260" x2="395" y2="360" stroke="#f57c00" stroke-width="4" marker-end="url(#arrowhead)"/>
    
    <!-- Encoder internal connections -->
    <line x1="395" y1="435" x2="240" y2="450" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowBlue)"/>
    <line x1="240" y1="515" x2="240" y2="525" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="235" y1="547" x2="285" y2="547" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowGreen)"/>
    <line x1="340" y1="515" x2="360" y2="515" stroke="#616161" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="460" y1="515" x2="460" y2="525" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="455" y1="547" x2="505" y2="547" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowGreen)"/>
    <line x1="460" y1="580" x2="395" y2="600" stroke="#4caf50" stroke-width="3" marker-end="url(#arrowGreen)"/>
    
    <!-- Decoder internal connections -->
    <line x1="870" y1="417" x2="890" y2="417" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowBlue)"/>
    <line x1="950" y1="435" x2="870" y2="490" stroke="#f44336" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="870" y1="515" x2="870" y2="525" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="850" y1="536" x2="870" y2="536" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowGreen)"/>
    <line x1="1020" y1="536" x2="1040" y2="536" stroke="#03a9f4" stroke-width="2" marker-end="url(#arrowBlue)"/>
    <line x1="1120" y1="536" x2="995" y2="560" stroke="#9c27b0" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="995" y1="582" x2="1005" y2="620" stroke="#4caf50" stroke-width="3" marker-end="url(#arrowGreen)"/>
    
    <!-- Cross attention -->
    <line x1="470" y1="620" x2="945" y2="525" stroke="#03a9f4" stroke-width="3" marker-end="url(#arrowBlue)"/>
    
    <!-- Final output -->
    <line x1="1005" y1="660" x2="700" y2="750" stroke="#d32f2f" stroke-width="4" marker-end="url(#arrowhead)"/>
  
    <!-- 图例 -->
    <rect x="50" y="800" width="500" height="90" rx="10" fill="#ffffff" stroke="#bdbdbd" stroke-width="2"/>
    <text x="300" y="825" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">组件图例 Legend</text>
    
    <rect x="70" y="840" width="30" height="18" rx="4" fill="url(#improvedGradient)" stroke="#f9a825" stroke-width="2"/>
    <text x="110" y="853" font-family="Arial, sans-serif" font-size="12" fill="#333">🔥 核心改进组件 (Temporal Embedding)</text>
    
    <rect x="70" y="865" width="30" height="18" rx="4" fill="url(#embeddingGradient)" stroke="#7b1fa2" stroke-width="2"/>
    <text x="110" y="878" font-family="Arial, sans-serif" font-size="12" fill="#333">📦 嵌入层组件 (Embedding Components)</text>
    
    <rect x="320" y="840" width="30" height="18" rx="4" fill="url(#rnnGradient)" stroke="#388e3c" stroke-width="2"/>
    <text x="360" y="853" font-family="Arial, sans-serif" font-size="12" fill="#333">🧠 RNN处理层 (LocalRNN)</text>
    
    <rect x="320" y="865" width="30" height="18" rx="4" fill="url(#informerGradient)" stroke="#f57c00" stroke-width="2"/>
    <text x="360" y="878" font-family="Arial, sans-serif" font-size="12" fill="#333">🤖 Transformer层 (R-Informer)</text>
  </svg>