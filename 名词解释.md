---

### 题目：在线外卖订餐系统

#### 系统描述：
设计一个在线外卖订餐系统，允许用户通过网站或移动应用浏览餐厅菜单、下单、支付并跟踪订单状态。系统还应支持餐厅管理员管理菜单、处理订单和查看销售记录。

#### 功能需求：
1. **用户功能**：
   - 用户注册与登录
   - 浏览餐厅及菜单
   - 添加菜品到购物车
   - 下单并选择支付方式（在线支付或货到付款）
   - 查看订单状态（待处理、配送中、已完成）
   - 取消未处理的订单
   - 查看订单历史

2. **餐厅管理员功能**：
   - 添加、删除、修改菜单信息
   - 接收并处理用户订单
   - 更新订单状态（如开始制作、配送中、已完成）
   - 查看销售记录和统计信息

#### 非功能需求：
- 系统应支持高并发访问，确保用户下单和支付的流畅性。
- 系统应保证用户支付信息的安全性。

#### 任务要求：
day1
1. **用例图**：绘制系统的用例图，展示用户和餐厅管理员的主要功能及其交互。
2. **顺序图**：绘制用户从浏览菜单到成功下单的顺序图，展示用户、系统、支付网关和数据库之间的交互过程。
3. **时序图**：绘制用户支付订单的时序图，展示用户、支付接口、系统之间的消息传递顺序。

day2
1.设计一个ER图，表示“在线外卖订餐系统”的数据库结构。包括“用户”、“订单”、“菜品”、“购物车”、“餐厅管理员”和“销售记录”等实体及它们之间的关系。
2.绘制“在线外卖订餐系统”的顶层数据流图（DFD）和一层数据流图。
3.设计一个状态图，表示“订单”的生命周期。展示从订单创建到订单完成或取消的状态变化，并描述每个状态之间的迁移条件和触发事件。
4.设计流程图，绘制用户从登录到成功下单的流程图，展示用户在整个流程中的操作步骤（如登录、浏览菜单、添加菜品、下单、支付等）以及系统的响应。

day3
1. 类图： 绘制系统的类图，展示系统中主要的类及其关系（如用户类、订单类、菜品类、支付类等），并标注类的属性和方法。
2. 对象图：基于类图，绘制一个具体的对象图，展示某一时刻系统中对象的状态（如一个用户对象、一个订单对象、一个菜品对象等）及其关系。
3. 构件图： 绘制系统的构件图，展示系统的主要模块（如用户界面模块、订单处理模块、支付模块、数据库模块等）及其依赖关系。
4. **部署图**：绘制系统的部署图，展示系统的物理部署结构（如客户端、Web服务器、应用服务器、数据库服务器等）以及它们之间的连接关系。

day5 
1.基于今天课堂学习的内容，请优化重构day3作业中类图、对象图（不改动day3已经提交的作业内容，完成后提交为day5的内容）；
2.请基于上述场景，绘制包图，可参考内容及步骤如下：
识别模块：根据功能需求，将系统划分为用户管理、订单管理、菜单管理、支付管理和餐厅管理等主要模块，每个模块应包含相关的功能或子模块。
（1）识别模块：根据功能需求，将系统划分为用户管理、订单管理、菜单管理、支付管理和餐厅管理等主要模块，每个模块应包含相关的功能或子模块。
（2）绘制包图：使用UML包图表示这些模块，标明包之间的依赖关系。例如，用户管理包依赖于订单管理包，订单管理包依赖于菜单管理和支付管理包等。
（3）确定模块内容：
      用户管理包：包含用户注册、登录、个人信息管理等功能。
      订单管理包：包含订单创建、状态更新、取消订单、查看订单历史等功能。
      菜单管理包：包含菜单的添加、删除、修改等功能。
      支付管理包：包含在线支付、货到付款等支付方式的管理。
      餐厅管理包：包含餐厅信息管理、订单处理、销售记录查看等功能。
（4）确定依赖关系：明确标注包之间的依赖关系，例如用户管理包依赖于订单管理包，订单管理包依赖于菜单管理和支付管理包等。

day6 
1.结合今天所学内容，检查并优化day01作业第2题：绘制用户从浏览菜单到成功下单的顺序图，展示用户、系统、支付网关和数据库之间的交互过程。
2.设计一个在线外卖订餐系统的订单状态图（状态机图），该图应描述一个订单从用户下单到订单完成的生命周期。
（1）状态包括：待处理、制作中、配送中、已完成、已取消;
（2）状态转换触发条件需要明确（如用户下单、管理员确认订单、配送开始等）;
（3）需要考虑用户取消订单、餐厅管理员更新订单状态的情况。

```mermaid
sequenceDiagram
    actor User as 用户
    participant System as 系统
    participant Payment as 支付网关
    participant DB as 数据库
    
    User->>System: 浏览餐厅菜单
    System->>DB: 查询菜单信息
    DB-->>System: 返回菜单数据
    System-->>User: 显示菜单列表
    
    User->>System: 选择菜品
    System-->>User: 显示菜品详情
    
    User->>System: 添加菜品到购物车
    System->>DB: 保存购物车信息
    DB-->>System: 确认保存成功
    System-->>User: 更新购物车展示
    
    User->>System: 查看购物车
    System->>DB: 获取购物车信息
    DB-->>System: 返回购物车数据
    System-->>User: 展示购物车内容及总价
    
    User->>System: 填写配送信息
    System->>DB: 验证配送地址
    DB-->>System: 返回验证结果
    System-->>User: 确认配送信息有效
    
    User->>System: 选择支付方式
    
    alt 在线支付
        User->>System: 选择在线支付
        System->>Payment: 创建支付订单
        Payment-->>System: 返回支付链接/界面
        System-->>User: 展示支付界面
        User->>Payment: 输入支付信息并确认
        Payment->>System: 支付结果回调
        System->>DB: 更新订单状态(已支付)
        DB-->>System: 确认更新成功
    else 货到付款
        User->>System: 选择货到付款
        System->>DB: 创建货到付款订单
        DB-->>System: 确认订单创建成功
    end
    
    System->>DB: 生成新订单
    DB-->>System: 返回订单ID
    System-->>User: 显示订单确认信息
```



3、设计一个在线外卖订餐系统的“用户下单并支付”流程的活动图，描述从用户浏览菜单到最终支付订单的过程（并画上具体的泳道）。包含以下关键步骤：
用户浏览餐厅菜单。
用户选择菜品并加入购物车。
用户填写配送信息。
用户选择支付方式（在线支付或货到付款）。
用户提交订单并支付。
活动图中需要明确用户的决策点（如选择支付方式）和系统的响应。

```mermaid
flowchart TD
    %% 定义泳道
    subgraph 用户
        A[开始] --> B[浏览餐厅菜单]
        B --> C[选择菜品]
        C --> D[添加到购物车]
        D --> E{继续购物?}
        E -->|是| B
        E -->|否| F[查看购物车]
        F --> G[填写配送信息]
        G --> H{选择支付方式}
        H -->|在线支付| I[发起支付]
        H -->|货到付款| K[确认订单]
        I --> J{支付成功?}
        J -->|是| K
        J -->|否| I
        K --> L[结束]
    end
    
    subgraph 系统
        B1[显示菜单数据] --> B
        C1[更新选择状态] --> C
        D1[更新购物车] --> D
        F1[计算订单金额] --> F
        G1[验证地址有效性] --> G
        I1[处理支付请求] --> I
        K1[创建订单记录] --> K
    end
    
    subgraph 支付网关
        I2[处理支付] --> I
        J1[返回支付结果] --> J
    end
    
    %% 连接不同泳道
    B --> B1
    C --> C1
    D --> D1
    F --> F1
    G --> G1
    I --> I1
    I --> I2
    I2 --> J1
    K --> K1
```

